\documentclass[12pt]{article}

\newif\ifsol
\soltrue

\include{macros}

\begin{document}
\begin{center}
\Large{\textbf{CAS CS 538.  \ifsol Solutions to \fi Problem Set 3}}\\
\smallskip
\large{\textbf{Due electronically via gradescope, Monday February 9, 2026 11:59pm
}}\\
\large{\textbf{Om Khadka, U51801771}}
\end{center}

\noindent

\subsection*{Problems}

\begin{problem} (10 points)
Suppose $\Adv$ in Attack Game 3.1 uses the following strategy. Choose a random $t\in \mathcal{S}$ and output $1$ if and only if $G(t)=r$. Suppose $G$ is injective. Compute $\PRGadv[\Adv, G]$.
\end{problem}
\begin{solution}
  The definition of the game is just gonna be the game 3.1 layout from the book (Graduate Course in Applied Cryptography). From the given attack methodology, we're essentially computing for
  \begin{equation*}
    \PRGadv[\A, G] = |\Pr[W_0] - \Pr[W_1]|
  \end{equation*}
  Where $W_b$ is just the chance that $\A$ returns 1 from any particular game.\\

  \textbf{$\exp 0$ (Using $G$)}\\
  In $\exp 0$, the following happens:
  \begin{itemize}
    \item Challenger picks $s \in^{R} \S$. Then, check if $r = G(s)$.
    \item Adversary $\A$ now gets $r$, chooses $t \in^{R} \S$, and outputs
    \begin{itemize}
      \item 1 IFF $G(t) = r$
      \item 0 otherwise
    \end{itemize}
  \end{itemize}
  Firstly, note that $G(t) = r$ can also be thought of as $G(t) = G(s)$. And since $G$ is one-to-one, $G(t)$ mapping out to $G(s)$ implies that $t = s$. Moreover, since $s, t$ are determined independently and randomly from $\S$, we're essentially just checking if, upon randomly selecting 2 values from $\S$, that those 2 values end up being the same from $\S$, which equates to
  \begin{equation*}
    \Pr[W_0] = \Pr[t = s] = \frac{1}{|\S|}
  \end{equation*}

  \textbf{$\exp 1$ (Using a rnd value)}\\
  In $\exp 1$, the following happens:
  \begin{itemize}
    \item Challenger picks $r \in^{R} \R$.
    \item Adversary then gets $r$, chooses $t \in^{R} \S$, and then outputs
    \begin{itemize}
      \item 1 IFF $G(t) = r$
      \item 0 else
    \end{itemize}
  \end{itemize}
  Now here, firstly note how $r$ is independent from $t, \S$, and random from $\R$. Also since $G$ is injective, this then means that this comparison is now just checking if some ranomly chosen seed, $G(t)$ happens to also be the same value as some truly random number, $r$. This equates to
  \begin{equation*}
    \Pr[W_1] = \Pr[t = r] = \frac{1}{|\R|}
  \end{equation*}

  So plugging these values back into our OG equation:
  \begin{equation*}
    \begin{aligned}
      \PRGadv[\A, G] &= |\Pr[W_0] - \Pr[W_1]|\\
      &= |\frac{1}{|\S|} - \frac{1}{|\R|}|\\
      &= \frac{1}{|\S|} - \frac{1}{|\R|}
    \end{aligned}
  \end{equation*}

  \textit{Note: Since $G$ is injective, there's no way that $S$ can map out to more values than in $\R$. That's why I omitted those $||$'s}

\end{solution}

\begin{problem} (20 points) Let $G : \left\{0,1 \right\}^n \to \left\{0,1 \right\}^{2n}$ be a secure PRG. Let $G'$ be a function where $G'(s)$ computes $G(s)$, deletes every third bit, and returns the result. Prove $G'$ is a secure PRG.
\end{problem}
 
\begin{solution}
  Before solving this, I'll just say that, intuitively, the reason why $G'$ is secure is because applying some random mathematical operation to an output won't meaningfuly change the message in such a way as to be recognizable (\textit{Like adding $1$ to all msgs $x$ doesn't reveal anything meaningful}.)\\

  I'll define the following:
  \begin{itemize}
    \item $G'(s) = $ the result of computing $y = G(s)$, and then removing every third bit in $y$.
    \item $L = 2n - [2n / 3] = $ the length of output $G'(s)$.
    \item $G' : \{0,1\}^n \to \{0, 1\}^L$.
  \end{itemize}

  Suppose, for the sake of contradiction, that $G'$ isn't secure. I'll make a new adversary, $\A'$, that'll then use $G'(s)$ to distinguish games using random inputs from games using the problem's defined input. That is,
  \begin{equation*}
    \PRGadv[\A', G'] = | \Pr_{s \leftarrow \{0, 1\}^n}[\A'(G'(s)) = 1] - \Pr_{r \leftarrow \{0, 1\}^L}[\A'(r) = 1]|
  \end{equation*}
  is non-negligible.\\

  The adversary, $\A$, will use $\A'$ to break $G$. $G$ will just be the attack methodology from Game 3.1 from the book from before. That is,
  \begin{itemize}
    \item $\exp 0$ will guess from a pseudo-rnd seed $s$
    \item $\exp 1$ will guess from a truly random value $y$.
  \end{itemize}

  \textbf{$\A$ construction:}
  \begin{itemize}
    \item Get $y = \{0, 1\}^{2n}$ from challenger.
    \item Compute $y' = y$ but with every third bit removed $(3, 6, ...)$.
    \item Run $\A'$ with $y'$ to get $b$.
    \item Return $b$.
  \end{itemize}

  \textbf{$\exp 0$:}\\
  Challenger will pick $s \leftarrow \{0, 1\}^n$, and then sends $y = G(s)$. $y'$ will then be $G'(s)$ by our defintion, otherwise meaning that:
  \begin{equation*}
    \Pr[\A \text{outputs } 1 | \exp 0] = \Pr_{s \leftarrow \{0, 1\}^n}[\A'(G'(s)) = 1]
  \end{equation*}

  \textbf{$\exp 1$:}\\
  The challenger will pick $y \leftarrow \{0, 1\}^{2n}$ at random. I claim that $y'$ is uniformly distributed over $\{0, 1\}^L$. This holds since each bit of $y$ is independent and random, and deleted fixed positions from these bits will still make it independent and random. In other words, I could say that the mapping of $f : \{0, 1\}^{2n} \to \{0, 1\} ^L$ is surjective (onto), and that each $z \in \{0, 1\}^L$ will have exxactly $2^{2n / 3}$ elements.\\

  Thusly, if $y$ is uniform, then $y' = f(y)$ is also uniform over $\{0, 1\}^L$, and therefore:
  \begin{equation*}
    \Pr[\A \text{outputs } 1 | \exp 1] = \Pr_{r \leftarrow \{0, 1\}^L}[\A'(r) = 1].
  \end{equation*}

  The advantage of $\A$ in distinguishing between the $G$'s will then be
  \begin{equation*}
    \PRGadv[\A, G] = |\Pr[\A \text{outputs } 1 | \exp 0] - \Pr[\A \text{outputs } 1 | \exp 1] = \PRGadv[\A', G']
  \end{equation*}

  Basically, since $\A$ is efficent, $\A'$ should be able to also have some non-negligible advantge against $G'$, making $\A$ also be non-negligible to $G$. But, $G$ is a secure PRG, and thusly no efficent adversary could even crack this. This contradicts the point that $\A'$ coul exist, and thus it doesn't, also proving that $G'$ is also secure.
\end{solution}

 
\begin{problem}
  In this problem you'll show that  secure PRG $G: \{0, 1\}^n \to \R$ can become insecure if the seed is not uniformly random in $\S$.
\end{problem}
\begin{ppart} (20 points)
  Consider PRG $G_a: \{0, 1\}^{n + 1} \to \R \times \{0, 1\}$ defined as $G_a(s) = G(s_1s_2 \ldots s_{n}) \parallel s_{n+1}$, where $s_1s_2\ldots s_{n+1}$ is the bit decomposition of $s$. Show that $G_a$ is a secure PRG assuming $G$ is secure.
\end{ppart}
\begin{solution}
  Assuming that $G$ is a secure PRG, I'll prove how $G_a$ is also secure via reduction.\\

  Let me define the following:
  \begin{itemize}
    \item $\A = $ efficent adversary against $G_a$
    \item $\PRGadv[\A, G_a] = |\Pr_{s \leftarrow \{0, 1\}^{n+1}}[\A(G_a(s)) = 1] - \Pr_{(r,b) \leftarrow \R \times \{0, 1\}}[\A(r, b) = 1]|.$
    \item $\B = $ a new adversary against $G$ with the following logic:
    \begin{itemize}
      \item $\B$ gets $z \in \R$ from the challenger, where $z = G(x)$ for uniform $x \in \{0, 1\}^n$ from $\exp 0$, or just uniform $z \in \R$ from $\exp 1$
      \item $\B$ picks a uniform bit $b \leftarrow \{0, 1\}.$
      \item $\B$ outputs $(z, b)$ to $\A$, an then outputs whatever $\A$ gives.
    \end{itemize}
  \end{itemize}

  \textbf{Exp 0:}\\
  In this case, $z = G(x)$ for uniform $x \in \{0, 1\}^n$. The pair $(z, b) = (G(x), b)$ is distribute exactly as $G_a(s)$ for $s = (x, b)$, since $x, b$ are both independent and random. Therefore,
  \begin{equation*}
    \Pr[\B \text{ outputs } 1 | \exp 0 \text{for } G] = \Pr_{s \leftarrow \{0, 1\}^{n+1}}[\A(G_a(s)) = 1].
  \end{equation*}

  \textbf{Exp 1:}\\
  In this case now, $z$ is just chosen uniformly from $\R$. Since $b$ is also uniform and independent from $z$, the pair $(z, b)$ will then also be uniform over $\R \times \{0, 1\}$. Therefore,
  \begin{equation*}
    \Pr[\B \text{ outputs } 1 | \exp 1 \text{for } G] = \Pr_{(r, b) \leftarrow \R \times \{0, 1\}}[\A(r, b) = 1].
  \end{equation*}

  Therefore the PRG advantage is:
  \begin{equation*}
    \PRGadv[\B, G] = |\Pr[\B \text{ outputs} 1 | \exp 0 \text{for } G] - \Pr[\B \text{ outputs } 1 | \exp 1 \text{for } G]| = \PRGadv[\A, G_a].
  \end{equation*}

  Since $G$ is secure, $\PRGadv[\B, G]$ will be negligible for any efficent $\B$. And since $\B$ is efficent (it esseentiall is only "flipping" a coin and then runs $\A$), $\PRGadv[\A, G_a]$ will also be negligible. Therefore, no efficent adversary will be able to distinguish $G_a$ from some random output, so $\therefore G_a$ is a secure PRG.
\end{solution}
\begin{ppart} (15 points)
  Show that $G_a$ is insecure if its random seed is chosen so that its last bit is always 0. Demonstrate an adversary and compute its advantage.
\end{ppart}
\begin{solution}
  In this part now, effectively what has changes is the seed value, $s$ from $G_a$, as when it's chosen, a 0 is appended to the end, effectively reucing the seed space to $\{0, 1\}^n \times \{0\}.$. For a seed $s = (x, 0)$, where $x \leftarrow \{0, 1\}^n$ is uniform, then the output should be
  \begin{equation*}
    G_a(x, 0) = G(x) || 0
  \end{equation*}
  Basically just restating that the last bit of the output will always be 0.\\

  For the contruction of $\A$, I will form the following:
  \begin{itemize}
    \item $\A$ gets a pair $(z, c) \in \R \times \{0, 1\}.$
    \begin{itemize}
      \item If $c = 0, \A$ returns 1 (or `real')
      \item Else, returns 0 (or just `random')
    \end{itemize}
  \end{itemize}

  \textbf{Exp 0 (Real) Analysis}\\
  The challenger will pick $x \leftarrow \{0, 1\}^n$, an then returns $(G(x), 0)$. The last bit $c$ will then always be 0, so Therefore
  \begin{equation*}
    \Pr[\A \text{ outputs } 1 | \exp 0] = 1.
  \end{equation*}

  \textbf{Exp 1 (Random) Analysis}\\
  The challenger now will pick $(r, b) \leftarrow \R \times \{0, 1\}$ uniformly. The last bit $b$ is uniform from $\{0, 1\}$, so therefore
  \begin{equation*}
    \Pr[\A \outputs 1 | \exp 1] = \Pr[b = 0] = 1/2.
  \end{equation*}

  So therefore, the advantage of $\A$ will be
  \begin{equation*}
    \PRGadv[\A, G_a] = |1 - \frac{1}{2}| = \frac{1}{2}.
  \end{equation*}

  This is a constant value (and a big one too), so the advantage is certainly non-negligible, making $G_a$ insecure.
\end{solution}
\begin{ppart} (15 points)
  Construct a secure PRG $G_c: \{0, 1\}^{n + 1} \to \R \times \{0, 1\}$ that becomes insecure if its seed $s$ is chosen so that the \emph{parity} of the bits in $s$ is always $0$ (where parity is defined as the XOR of all the bits). Hint: a small change to $G_a$ is all you need here. Note that you will need to prove two separate facts: that $G_c$ is secure when its seed is uniform, and that $G_c$ is insecure when when the parity of the bits of $s$ is 0. Both of these proofs can use the previous parts, even if you have not solved them.
\end{ppart}

\begin{solution}
  Firstly, let me just construct and define $G_c$ as the following: \\

  For $s = s_1 \ldots s_{n+1} \in \{0, 1\}^{n + 1}$, let 
  \begin{equation*}
    G_c(s) = G(s_1 \ldots s_n) || (\underset{i = 1}{\overset{n  +1}{\bigoplus}}s_i).
  \end{equation*}
  where $G : \{0, 1\}^n \to \R$ is a secure PRG, and the XOR symbol just being XOR from bottom to top. This equation is basically saying that $G_c$ with reutnr a pseudornd string, $G(s_1 \ldots s_n)$, with a single parity bit appended to the end of the seed.\\

  Now, asuppose $G$ is a secure PRG, then I can prove that $G_c$ is also secure with this problem's seed, $s \in^{R} \{0, 1\}^{n+1}$.\\

  Let $\A$ be our efficent adversary for $G_c$. Then, $\B$ will be our other efficent adversary for $G$, where
  \begin{itemize}
    \item $\B$ gets a string $z \in^{R} \R$ from the challenger ($z = G(x)$, for a uniform $x$ if it's $\exp 0$, or just random $z$ for $\exp 1$).
    \item $\B$ then chooses an independent uniform bit, $p \leftarrow \{0, 1\}$.
    \item $\B$ will then output $(z, p)$ to $\A$, and then return the output of $\A$.
  \end{itemize}

  \textbf{Exp 0}\\
In this case, $z = G(x)$ for uniform $x \in^R \{0, 1\}^n$. Then, $(z, p)$ will then be distributed in the same manner to $G_c(s)$, for a uniform $s$. This is because, I coul write $s = (x, s_{n + 1})$ with $x$ being uniform an $s_{n + 1}$ being both uniform and independent. Then, the parity bit will be , $\underset{i = 1}{\overset{n + 1}{\bigoplus}}s_i = (\underset{i = 1}{\overset{n}{\bigoplus}}x_i) \oplus s_{n + 1}$. \\
Given $x$, this bit is uniform since $s_{n + 1}$ is also uniform. Morever, the parity bit is independent of $x$ (since for any fixe $x$, it's also uniform). So then therefore, the pair, $(G(x), \text{parity})$, will then have to have the same distribution as $(G(x), p)$, where $p$ is independent and uniform. Thus, the Pr of this case is
\begin{equation*}
  \Pr_{s \leftarrow \{0, 1\}^{n + 1}}[\A(G_c(s)) = 1].
\end{equation*}

\textbf{Exp 1}\\
In this case, $z$ is just uniform over $\R$, and $p$ is both uniform and independent. So, $(z, p)$ are both uniform over $\R \times \{0, 1\}$. And thus,
\begin{equation*}
  \Pr[\B \text{ outputs } 1 | \exp 1] = \Pr_{(r, b) \leftarrow \R \times \{0, 1\}}[\A(r, b) = 1].
\end{equation*}

So then therefore, the PRGadv will be
\begin{equation*}
  \PRGadv[\B, G] = |\Pr[\B \text{ outputs } 1 | \exp 0] - \Pr[\B \text{ outputs } 1 | \exp 1] = \PRGadv[\A, G_c].
\end{equation*}
And since $G$ is secure, $\PRGadv[\B, G]$ will be negligible, thus showing that $\PRGadv[\A, G_c]$ also being neglibigle for efficent $\A$, so then $\therefore G_c$ is secure, \textbf{But only if we're using uniform seeds.}\\\\


Consider the case now where the seed, $s$ is chosen uniform from the set, such that
\begin{equation*}
  \{s \in \{0, 1\}^{n+1} : \underset{i = 1}{\overset{n+1}{\bigoplus}}s_i = 0 \}.
\end{equation*}
For any such $s$, the parity bit (being the last bit for $G_c(s)$) will then ALWAYS be 0. Therefore, $G_c(s) = (G(s_1 \ldots s_n), 0)$.\\

Now let $\A$ be a distinguisher $G_c$ from random values with a non-negligible advantage. It would work as such:
\begin{itemize}
  \item $\A$ gets pair $(z, b) \in \R \times \{0, 1\}$.
  \item If $b = 0$, output 1 ("real")
  \item If not, output 0 ("random")
\end{itemize}

For \textbf{Exp 0}, The challenger will pick $s$ uniformly from seeds with parity 0, and then return that, $G_c(s) = (G(x), 0)$, where $x$ are the first $n$ bits. Thus, the last bit is ALWAYS 0, meaning that $\A$ will always output 1 (probability 1).

For \textbf{Exp 1}, The challenge will then pick $(r, b)$ uniformly over $\R \times \{0, 1\}$. Thusly, $\Pr[b = 0] = \frac{1}{2}$, so $\A$ will output 1 with a probability of just $\frac{1}{2}$.\\


Therefore the PRGAdv becomes
\begin{equation*}
  \PRGadv[\A, G_c] = |1 - \frac{1}{2}| = \frac{1}{2}, 
\end{equation*}
Which is like again a non-negligible (const) advantage, meaning that $G_c$ would then become insecure \textbf{if the seeds are forced to be of parity 0.}
\end{solution}

\begin{problem} (20 points)

Let $G : \left\{0,1 \right\}^n \to \R$ be a secure PRG, and consider $G'$ defined as $G'(s) = G(s) \parallel G(s+1)$. Prove that  $G'$ is not necessarily a secure PRG. \textit{(Hint: Use problem 3a.)}
\end{problem}

\begin{solution}
Suppose the following \textit{counterexample}: a specific secure PRG \(G\) such that \(G'\) is insecure.\\

Let \(H: \{0,1\}^{n-1} \to \mathcal{R}_0\) be a secure PRG (this type of PRG should be valid). Then we can define \(G: \{0,1\}^n \to \mathcal{R}_0 \times \{0,1\}\) to be 
\[
G(s) = H(s_1 \dots s_{n-1}) \parallel s_n,
\]  
where \(s = s_1 \dots s_n\). From the previous Problem, 3(a), \(G\) it's already been proven that this is a secure PRG.\\

Now consider \(G'(s) = G(s) \parallel G(s+1)\), where \(s+1\) denotes incrementing \(s\) as an \(n\)-bit integer modulo \(2^n\). Then I could write \(s = x \parallel b\) with \(x \in \{0,1\}^{n-1}\) and \(b \in \{0,1\}\).

\begin{itemize}
  \item If \(b = 0\) : \(s = x0\), so \(s+1 = x1\). Then  
        \[
        G(s) = H(x) \parallel 0, \quad G(s+1) = H(x) \parallel 1.
        \]
  \item If \(b = 1\) : \(s = x_1\), so \(s+1 = (x+1)0\). Then  
        \[
        G(s) = H(x) \parallel 1, \quad G(s+1) = H(x+1) \parallel 0.
        \]
\end{itemize}

Thus, in \(G'(s) = G(s) \parallel G(s+1)\), the last bit of the first half (all the way to \(L+1\), where \(L\) is the length of the output, \(H\)) equals \(b\), and the last bit of the second half (to \(2(L+1)\)) equals \(1-b\). Basically, these two bits are always different.\\

Now let's make an adversary \(\mathcal{A}\) for \(G'\) as follows. For the input of \(y \in \{0,1\}^{2(L+1)}\):
\begin{enumerate}
\item Let \(a\) be the bit at position \(L+1\) (the last bit of the first half).
\item Let \(a'\) be the bit at position \(2(L+1)\) (the last bit of the second half).
\item If \(a \neq a'\), output 1 (guess “real”); otherwise output 0 (guess “random”).
\end{enumerate}

Comparing the 2 experiments:
\begin{itemize}
\item \textbf{Experiment 0 (real):} The challenger will pick \(s \leftarrow \{0,1\}^n\), and then return \(y = G'(s)\). Since \(a\) and \(a'\) are always different, \(\mathcal{A}\) outputs 1 always (probability 1).
\item \textbf{Experiment 1 (random):} Now the challenger will pick \(y \leftarrow \{0,1\}^{2(L+1)}\) uniformly. Then \(a\) and \(a'\) are independent uniform bits, so then \(\Pr[a \neq a'] = \frac{1}{2}\). Therefore, \(\mathcal{A}\) probability to output 1 will be \(\frac{1}{2}\).
\end{itemize}

Therefore,
\[
\operatorname{PRGadv}[\mathcal{A}, G'] = \left| 1 - \frac{1}{2} \right| = \frac{1}{2},
\]
which is non-negligible (a const like again). Thus, \(G'\) is not a secure PRG.
\end{solution}

\end{document}


