\documentclass[12pt]{article}

\newif\ifsol
\soltrue

\include{macros}

\begin{document}
\begin{center}
\Large{\textbf{CAS CS 538.  \ifsol Solutions to \fi Problem Set 2}}\\
\smallskip
\large{\textbf{Due electronically via gradescope, Monday February 2, 2026 11:59pm
}}
\end{center}

\subsection*{Useful Definitions}

A function is negligible is if goes to zero very quickly. How quickly? Faster than $1/n$, $1/n^2$, $1/n^3$, etc. Formally, we have the following definition.

\begin{shaded*}
\begin{definition}[Negligible function]
    A function $f : \mathbb{Z}_{\ge 1} \to \mathbb{R}$ is \textbf{negligible} if for all integers $c>0$, we have \[
        \lim_{n \to \infty} f(n) \cdot n^c  = 0
    .\]
\end{definition}
\end{shaded*}

We will need negligible functions to formalize security (basically, we will want to make sure that the probability of adversarial success is negligible). See Chapter 2.3.1 of Boneh \& Shoup textbook. 


\begin{definition}[Semantic security advantage]
   For a given cipher $\E= \left(E,D \right) $ defined over $\left( \K,\M\C \right) $ and for a given adversary $\Adv$, we define two experiments, Experiment 0 and Experiment 1. For $b\in \left\{0,1 \right\}$, we define Experiment $b$ as follows:
   \begin{itemize}
       \item The adversary computes $m_0, m_1 \in \M$, of the same length, and sends them to the challenger.
       \item The challenger computs $k \rfrom \K, c \rfrom E(k, m_b)$, and sends $c$ to the adversary. 
       \item The adversary outputs a bit $\hat{b} \in \left\{ 0,1 \right\} $.
   \end{itemize}
   For $b \in \left\{0,1 \right\}$, let $W_b$ be the event that $\Adv$ outputs 1 in Experiment $b$. We define $\Adv$'s \textbf{semantic security advantage} with respect to $\E$ as \[
   \SSadv[\Adv, \E] := \left| \Pr[W_0]- \Pr[W_1] \right| 
.\]
\end{definition}

\begin{definition}[Semantic security]
   A cipher $\E$ is \textbf{semantically secure} if for all efficient adversaries $\Adv$, the value $\SSadv[\A, \E]$ is negligible.
   
\end{definition}

\subsection*{Problems}

\begin{problem} (15 points)

Show that each of the following functions are negligible:
\begin{enumerate}[label=\alph*)]
    \item $f(n) + g(n)$, where $f(n)$ and $g(n)$ are both negligible
    \item $1000 \cdot f(n)$, where $f(n)$ is negligible
    \item $\frac{1}{2^{\sqrt{n}}}$ 
\end{enumerate}
    
\end{problem}

\begin{solution}
For \textbf{a}, let $c > 0$ be any positive int. Since $f(n)$ is negligible, by its definition we have:

\begin{equation*}
    \lim_{n \rightarrow \inf} f(n) \cdot n^c = 0
\end{equation*}

The same can be said for $g(n)$ too: 

\begin{equation*}
    \lim_{n \rightarrow \inf} g(n) \cdot n^c = 0
\end{equation*}

Using limit properties (property of sums), we can then get:

\begin{equation*}
    \begin{aligned}
        \lim_{n \rightarrow \infty}[f(n) + g(n)] \cdot n^c &= \lim_{n \rightarrow \infty}[f(n) \cdot n^c + g(n) \cdot n^c] \\
        &= \lim_{n \rightarrow \infty} f(n) \cdot n^c + \lim_{n \rightarrow \infty} g(n) \cdot n^c \\
        &= 0 + 0 = 0
    \end{aligned}
\end{equation*}

Since this holds for any int $c > 0$, this proves that \textbf{a} is negligible. \\ \\


For \textbf{b}, let $c > 0$ be any positive int. Like before, $f(n)$ is negligible, so:

\begin{equation*}
    \lim_{n \rightarrow \inf} f(n) \cdot n^c = 0
\end{equation*}

Using limit properties (that of multiples), we then get: 

\begin{equation*}
    \begin{aligned}
        \lim_{n \rightarrow \infty}[1000 \cdot f(n)] \cdot n^c = \lim_{n \rightarrow \infty} 1000 \cdot [f(n) \cdot n^c] \\
        &= 1000 \cdot \lim_{n \rightarrow \infty} f(n) \cdot n^c \\
        &= 1000 \cdot 0 = 0
    \end{aligned}
\end{equation*}

As it holds for all $c > 0$, this proves \textbf{b} is negligible. \\ \\

For \textbf{c}, let $c > 0$ be any positive int. We now need to show that, as $n$ grows, $\frac{1}{2^{\sqrt{n}}}$ will decay into something negligible (so to 0 essentially). Firstly, consider the expression:

\begin{equation*}
    \frac{1}{2^{\sqrt{n}}} \cdot n^c = \frac{n^c}{2^{\sqrt{n}}}
\end{equation*}

I'll show now how $\lim_{n \to \infty} \frac{n^c}{2^{\sqrt{n}}} = 0$ using limit properties.

Firstly, take the natural log:

\begin{equation*}
    \ln(\frac{n^c}{2^{\sqrt{n}}}) = \ln(n^c) - \ln(2^{\sqrt{n}}) = c \ln n - \sqrt{n} \ln 2
\end{equation*}

Taking this equation, we can now consider it as a limit as $n \to \infty$:

\begin{equation*}
    \lim_{n \to \infty}[c \ln n - \sqrt{n} \ln 2] = ???
\end{equation*}

Now looking at this expression, consider \textit{which} term would grow faster consider the circumstances. $c \ln n$, or $\sqrt{n} \ln 2$? Well, the first term is essentially being multipled by a constant, $c$. The latter term, however, \textbf{is the multiple}. Therefore we can assume that the 2nd term will dominate this growth.

\begin{equation*}
    \lim_{n \to \infty}[c \ln n - \sqrt{n} \ln 2] = -\infty
\end{equation*}

Now we can take this result and plug it back into our original negligible function that we're considering:

\begin{equation*}
    \begin{aligned}
        \lim_{n \to \infty}\frac{n^c}{2^{\sqrt{n}}} = \lim_{n \to \infty}e^{\ln(\frac{n^c}{2^{\sqrt{n}}})} \\
        &= e^{-\infty} \\
        &= 0
    \end{aligned}
\end{equation*}

And since this applies for all $c > 0$, this proves \textbf{c}.

\end{solution}

\begin{problem} (30 points)

    You're a rising spy working your way up the ranks of national intelligence. One day you are sent a top-secret mission via a mysterious encrypted message. It's a single clue: a three-character airport code for one of the following airports in five possible countries:
    \begin{center}
    \begin{tabular}{c | c | c | c | c}
        \textbf{USA} & \textbf{Germany} & \textbf{China} & \textbf{Brazil} & \textbf{India}\\
        \hline
        BOS & MUC & PEK & GIG & DEL\\
        JFK & FRA & SZX & BSB & BOM \\
        LAX & DUS & PVG & GRU & MAA\\
        DCA & HAM & CAN & CGH & BLR\\
    \end{tabular}
    \end{center}

Unbeknownst to you, a copy of the ciphertext was intercepted by a rival attempting to learn which country you are going to. 


Consider the following security game between a challenger and an adversary. 
Let $\Scheme=(\Enc, \Dec)$ be a computational cipher with message space $\M$ equal to the set of 20 airport codes above. 
The challenger chooses a random plaintext $m\rfrom \M$ and key $k\rfrom \K$, computes $c\rfrom \Enc(k, m)$ and sends $c$ to the adversary. The adversary $\Adv$ outputs a string $s$ from the following set: \[
    \left\{ \verb|"USA"|, \verb|"Germany"|, \verb|"China"|, \verb|"Brazil"|, \verb|"India"|\right\} 
.\]
Let $\country(m)$ be a function that outputs the country string in which a given airport code is located. Let $W$ be the event that $s = \country(m)$, let $p= \Pr[W]$, and define $\countryguessadv[\Adv, \Scheme] = |p - \frac{1}{5}|$. 

Prove that if $\Scheme$ is a semantically secure cipher (per Section 2.2.2 of the textbook), then for any efficient adversary $\A$, $\countryguessadv[\A,\Scheme]$ is negligible. Notice what this implies: your rival's attempt to learn which country you're travelling to is at most negligibly better than random guessing.

\textit{To prove this, use a reduction: supposing there exists an efficient adversary with non-negligible advantage in the country-guessing game, construct an efficient adversary with non-negligible advantage in the semantic security game. }

\end{problem}

\pagebreak

\begin{solution}
I'll prove the \textbf{contrapositive} here, so: If there exists some efficent adversary $\A$ with a non-negligible advantage, then we can make an efficent adversary $\B$ also with a non-negligible advantage in the semantic security game, meaning that $\Scheme$ isn't secure.\\

Given $\A$ for the country-guessing game with $\countryguessadv[\A,\Scheme] = \epsilon$, we can make $\B$ for the semantic security game as follows:

\begin{itemize}
    \item $\B$ will choose 2 distinct countries $C_0$, $C_1$ from ${\text{USA, Germany, China, Brazil, India}}$.
    \item For each country $C_i$, $\B$ choose some arbitary airport code $m_i$ from that country.
    \item $\B$ will then submit $m_0$, $m_1$ to the semantic security challenger (\textit{important to note how these codes will have the same length, all codes are 3-characters long.})
    \item The challenger chooses $b \gets {0,1}$, $k \gets \K$, computs $c \gets \Enc(k, m_b)$, and then sends $c$ to $\B$.
    \item $\B$ then sends result $c$ to $\A$ and recieves $\A$'s output  \\
    $s \in {\text{"USA"}, \text{"Germany"}, \text{"China"}, \text{"Brazil"}, \text{"India"}}$.
    \item $\B$ outputs $\hat{b}$ in accordance to the following rule:
    \begin{itemize}
        \item If $s = \country(m_0)$, output $\hat{b} = 0$.
        \item If $s = \country(m_1)$, output $\hat{b} = 1$
        \item Elser, output rnd $\hat{b} \gets {0,1}$
    \end{itemize}
\end{itemize}

Let $W_b$ be the occurance that $\B$ outputs 1 in Experiement $b$ of the semantic security game. \\

\textbf{Case 1: $b = 0$} (challenger encrypts $m_0$)
\begin{itemize}
    \item This case basically says that $\A$ recieves $m_0$ as encryption.
    \item Let $p_0 = \Pr[\A \text{ outputs } \country(m_0) \mid \text{encryption of } m_0]$.
    \item Let $p_1 = \Pr[\A \text{ outputs } \country(m_1) \mid \text{encryption of } m_0]$.
    \item Then, $\Pr[W_0] = \Pr[\B \text{ outputs } 1 \mid b=0] = p_1 + \frac{1}{2}(1 - p_0 - p_1)$
\end{itemize}

\textbf{Case 2: $b = 1$} (challenger encrpyts $m_1$)
\begin{itemize}
    \item In this case, $\A$ insteads gets $m_1$.
    \item Let $q_0 = \Pr[\A \text{ outputs } \country(m_0) \mid \text{encryption of } m_1]$.
    \item Let $q_1 = \Pr[\A \text{ outputs } \country(m_1) \mid \text{encryption of } m_1]$.
    \item Then, $\Pr[W_1] = \Pr[\B \text{ outputs } 1 \mid b=1] = q_1 + \frac{1}{2}(1 - q_0 - q_1)$.
\end{itemize}

By the definition of $\countryguessadv$, we know that, overall, $\A$ will guess the correct country with a probability of $\frac{1}{5} + \delta$ for some $\delta$ (where $|\delta| = \epsilon$, and we can then also assume that \textit{,in general}, that $\delta > 0$ because otherwise we could just flip $\A$'s output). \\

When looking at the specific countries $C_0$, $C_1$, $\A$ NEEDS to have AT LEAST the avg. adv. Then \textit{in general}, we then assume that $\A$ is AT LEAST as good at distinguishing between $C_0, C_1$ as between any other pair of countries. We then get:     

\begin{equation*}
    \frac{p_0 + q_1}{2} \geq \frac{1}{5} + \frac{\epsilon}{2}
\end{equation*}

This is because, when encryption $m_0$, $\A$ should output $\country(m_0)$, with a probability of AT LEAST $\frac{1}{5} + \frac{\epsilon}{2}$, and similarily of that for $m_1$.\\

Then, the semantic security advantage for $\B$ becomes:

\begin{equation*}
    \begin{aligned}
        \SSadv[\B,\Scheme] &= |\Pr[W_0] - \Pr[W_1]| \\
        &= \left| \left(p_1 + \frac{1}{2}(1 - p_0 - p_1)\right) - \left(q_1 + \frac{1}{2}(1 - q_0 - q_1)\right) \right| \\
        &= \left| \frac{1}{2}(p_1 - p_0 - p_1 + q_0 + q_1 - q_1) \right| \\
        &= \frac{1}{2}|q_0 - p_0|
    \end{aligned}
\end{equation*}

Now, since $\A$ has that advantage $\epsilon$ overall, and we've chosen the counties where $\A$ performs best, we now have $|q_0 - p_0| \geq \frac{\epsilon}{5}$. \textit{Note that the factor comes from the num. of possible counties. This means, worst case, $\A$'s adv. is spread evenly across all country pairs.}\\  

Therefore:
\begin{equation*}
    \SSadv[\B, \Scheme] \geq \frac{\epsilon}{10}
\end{equation*}

Since $\epsilon$ is non-negligible by our assumption, $\frac{\epsilon}{10}$ will then also be non-negligible (this is proven from our answer from \textbf{1} as well, we can apply limit properties to preserve non-negligibility). \\

By proving this, we ultimately show that $\B$ is an efficent adversary. This proves the contrapositive of the OG statements, therefore proving the original statement.
\end{solution}
 
\begin{problem} (30 points)
Let $\Scheme$ be a computational cipher with $|\K| < |\M|$.
Construct an adversary $\Adv$ against $\Scheme$ such that the running time of $\Adv$ is very reasonable (in fact, comparable to the running time of $\Enc$ and $\Dec$) and $\SSadv[\Adv, \Scheme]>0$. Note that it is okay if $\SSadv[\Adv, \Scheme]$ is very small, as long as it is positive.

You must demonstrate what the adversary does and prove that its $\SSadv$ is positive.
The adversary should \textbf{not} depend on any knowledge about $\Scheme$ that cannot be efficiently obtained (for example, the adversary doesn't know exact probabilities of different ciphertexts).

\emph{Hint: For the adversary design, use the idea from Discussion 2 Problem 2. You can't perform exhaustive search, of course, because you don't have the time; make a random guess instead. Then analyze the probability of outputting 1 in each of the two experiments. This analysis will be different from the one in discussion --- go back to your first principles of probability. Conclude that it has non-zero advantage.}

This problem justifies why any reasonable definition of semantic security must allow for at least a negligible advantage for $\Adv$ even when the running time of $\Adv$ is limited.
\end{problem}

\begin{solution}
Back in last week's discussion, the solution to the referred question involved us essentially doing this exhaustive key search, eventually getting us that $\SSadv$, but being really inefficent. This attack however, could just be accomplished by basically \textit{randomly choosing msgs and keys and interpreting their ciphertexts and outputs.}\\

Given the cipher with the above properties, we can make an adversary $\Adv$ as follow:

\begin{itemize}
    \item $\Adv$ chooses 2 distinct msgs $m_0, m_1 \gets \mathcal{M}$ uniformly at rnd (making sure $m_0 \neq m_1$).
    \item $\Adv$ sends $m_0, m_1$ to the challenger.
    \item The challenger outputs ciphertext $c \gets \Enc(k, m_b)$ for $b \gets {0,1}$.
    \item $\Adv$ chooses a rnd key $k' \gets \mathcal{K}$ uniformly.
    \item $\Adv$ computes $m' \gets \Dec(k', c)$.
    \item $\Adv$ outputs 1 if $m' = m_0$, and 0 otherwise.
\end{itemize}

The running time of this adversary is dominated by the one $\Dec$ operation, and is therefore comparable to the running time of $\Enc$ and $\Dec$. This satisfies the time constraint for this problem.\\

Now, let $W_b$ be the occurance that $\Adv$ outputs 1 in Experiment $b$. I can now analyze $\Pr[W_0]$ and $\Pr[W_1]$.

\textbf{Experiment 1: $b = 0$ ($c$ is an encryption of $m_0$ with some key $k^*$)}

    \begin{itemize}
        \item The real key $k^*$ satisfies $\Dec(k^*, c) = m_0$
        \item When $\Adv$ picks $k' = k^*$ (which happens with a chance of $1/|\mathcal{K}|$), $\Dec(k', c) = m_0$
        \item When $\Adv$ picks $k' \neq k^*$, $\Dec(k', c)$ could be $m_0$ or something else
        \item Let $p = \Pr[\Dec(k', c) = m_0 \mid k' \neq k^*]$
        \item Then, \\
        \begin{equation*}
            \Pr [W_0] = \frac{1}{|\K|} + (1 - \frac{1}{|\K|})p
        \end{equation*}
    \end{itemize}

\textbf{Experiment 2: $b = 1$ ($c$ is an encryption of $m_1$ with some key $k^*$.)}

    \begin{itemize}
        \item Now, the real key $k^*$ satisfies $\Dec(k^*, c) = m_1 \neq m_0$
        \item When $\Adv$ picks $k' = k^*$ (the probability is $1/|\mathcal{K}|$), $\Dec(k', c) = m_1 \neq m_0$
        \item When $\Adv$ picks $k' \neq k^*$, $\Dec(k', c)$ can by any other wrong answer.
        \item Let $q = \Pr[\Dec(k', c) = m_0 \mid k' \neq k^*]$
        \item Therefore, \\
        \begin{equation*}
            \Pr [W_1] = 0 \cdot \frac{1}{|\K|} + (1 - \frac{1}{|\K|}) q = (1 - \frac{1}{|\K|}) q
        \end{equation*}
    \end{itemize}

Now, since $|\mathcal{K}| < |\mathcal{M}|$, each ciphertext $c$ can be decrypted to AT MOST $|\mathcal{K}|$ different messages (one / key). Over all possible $k' \in \mathcal{K}$, the values $\Dec(k', c)$ take AT MOST $|\mathcal{K}|$ distinct values. Since $m_0$ was chosen uniformly from $\mathcal{M}$ and $|\mathcal{K}| < |\mathcal{M}|$:

\begin{equation*}
    q \leq \frac{|\K|}{|\M|} < 1
\end{equation*}

Moreover, experiment 0 shows show that we know AT LEAST 1 key ($k^*$) that does decrypt to $m_0$, so:

\begin{equation*}
    p \geq \frac{1}{|\K|} \text{(or, the fraction of keys that decrypt } c \text{ to } m_0 \text{)}
\end{equation*}

This can also be thought of as:

\begin{equation*}
    p = \frac{\text{number of keys } k' \text{ with } \Dec(k', c) = m_0}{|\mathcal{K}|} \geq \frac{1}{|\mathcal{K}|}
\end{equation*}

And therefore: 

\begin{equation*}
    \begin{aligned}
        \Pr [W_0] - \Pr [W_1] \\
        &= [ \frac{1}{|\K|} + (1 - \frac{1}{|\K|}) p] - (1 - \frac{1}{|\K|}) q \\
        &= \frac{1}{|\K|} + (1 - \frac{1}{|\K|})(p-q)
    \end{aligned}
\end{equation*}

Since $p \geq 1/|\mathcal{K}|$ and $q \leq |\mathcal{K}|/|\mathcal{M}| < 1$, and $1/|\mathcal{K}| > 0$, we have:

\begin{equation*}
    \Pr [W_0] - \Pr [W_1] > 0
\end{equation*}

Thusly, $\SSadv[\Adv, \Scheme] = |\Pr[W_0] - \Pr[W_1]| > 0$, giving us an efficent attack that breaks the original cipher algorithm.
\end{solution}

% \begin{problem} (25 points)

% For this problem, you will prove that applying an insecure cipher on top of a secure cipher can still result in a secure cipher.

% Let $(\cenc, \cdec)$ be a Caeser cipher on bytes over $\left( \K_1, \M_1, \C_1 \right) $, where $\K_1 = \left\{0,1 \right\}^8$, $\M_1 = \left\{ 0,1 \right\} ^{8L}$, and $\C_1 = \left\{0,1 \right\}^{8L}$. Concretely,  

% \begin{figure}[h!]
% \center
% \begin{subfigure}{0.4\linewidth}
% \titlecodebox{\cenc(k, m)}{
%     \> for $i =0$ to $L-1$:\\
%     \> \> $c_i := k \oplus m[8i:8(i+1)]$\\
%     \> $c := c_0 \parallel c_1 \parallel \cdots \parallel c_{L-1}$\\
%     \> return $c$
% }
% \end{subfigure}
% \begin{subfigure}{0.4\linewidth}
% \titlecodebox{\cdec(k, c)}{
%     \> for $i =0$ to $L-1$:\\
%     \> \> $m_i := k \oplus c[8i:8(i+1)]$\\
%     \> $m := m_0 \parallel m_1 \parallel \cdots \parallel m_{L-1}$\\
%     \> return $m$
% }
% \end{subfigure}
% \end{figure}

% Let $\E=(\Enc, \Dec)$ be a semantically secure cipher over $\left( \K_2,\M_2,\C_2 \right) $, where $\C_2 = \left\{0,1 \right\}^{8L}$. Define a modified encryption scheme $\E' = \left( \Enc', \Dec' \right) $ over $\left( \K_1 \times \K_2, \M_2, \C_1 \right) $, where 
% \begin{align*}
%     \Enc'((k_1, k_2) ,m) &= \cenc(k_1, \Enc(k_2, m))\\
%     \Dec'((k_1,k_2), c) &= \Dec(k_2, (\cdec(k_1, c))
% .\end{align*}
% Prove that $\E'$ is as secure as $\E$. That is, prove that for any adversary $\Adv$, there is an adversary $\B$ of similar running time such that $\SSadv[\B, \E] = \SSadv[\Adv, \E']$.
% \end{problem}

% \begin{solution}
% Your solution goes here
% \end{solution}

\begin{problem}(25 points)[Boneh-Shoup Exercise 2.10 from Section 2.6]
Let $\Scheme = (\Enc, \Dec)$ be a semantically
secure cipher defined over $(\K,\M, \C)$, where $\M = \C = \{0, 1\}^L$. 
Which of the following encryption algorithms yields a semantically secure scheme? 
Either give an attack or provide a security proof via an explicit reduction.

\begin{ppart}
    Let $\Scheme_{1}$ be a scheme s.t. $\Enc_1(k,m) := 0 || \Enc(k,m)$

\begin{solution}
The answer is that \textbf{this scheme is secure}, and I'll prove how the prepending of basically this 0-bit doesn't reveal any extra info to an attacker.\\

I'll show that, if there exists an efficient adversary $\A_1$ with non-negligible advantage against $\Scheme_1$, then it is possible to build an efficient adversary $\B$ with non-negligible advantage against the original semantically secure scheme $\Scheme$.

Given our adversary $\A_1$ against $\Scheme_1$, we can make another adversary $\B$ against $\Scheme$ as follows:

\begin{itemize}
    \item $\B$ receives $m_0, m_1$ from $\A_1$ (or makes them according to $\A_1$, doesn't matter here how $\A_1$ makes it for now).
    \item $\B$ sends $m_0, m_1$ to the $\Scheme$ challenger.
    \item The $\Scheme$ challenger selects $b \gets {0,1}$, $k \gets \K$, computes $c \gets \Enc(k, m_b)$, and sends $c$ to $\B$.
    \item $\B$ prepends 0 to $c$ to create $c_1 = 0 || c$.
    \item $\B$ sends $c_1$ to $\A_1$.
    \item $\B$ outputs whatever bit $\A_1$ outputs.
\end{itemize}

Now, let $W_b^{\B}$ be the ocurrance that $\B$ outputs 1 in Experiment $b$ of the $\Scheme$ security game, and let $W_b^{\A_1}$ be the occurance that $\A_1$ outputs 1 in Experiment $b$ of the $\Scheme_1$ security game.\\

In Experiment $b$:
\begin{itemize}
    \item $\B$ receives $c = \Enc(k, m_b)$ from the $\Scheme$ challenger
    \item $\B$ constructs $c_1 = 0 || c = 0 || \Enc(k, m_b) = \Enc_1(k, m_b)$
    \item But, this is exactly what $\A_1$ would receive in Experiment $b$ of the $\Scheme_1$ game
    \item Therefore, for $b = 0, 1$: 
    \begin{equation}
        \Pr[W_b^{\B}] = \Pr[W_b^{\A_1}]
    \end{equation}
    \item And therefore,
    \begin{equation}
        \SSadv[\B, \Scheme] = |\Pr[W_0^{\B}] - \Pr[W_1^{\B}]| = |\Pr[W_0^{\A_1}] - \Pr[W_1^{\A_1}]| = \SSadv[\A_1, \Scheme_1]
    \end{equation}
\end{itemize}

 If $\A_1$ has some non-negligible advantage against $\Scheme_1$, then $\B$ has that same non-negligible advantage against $\Scheme$. But $\Scheme$ is assumed to be semantically secure, so it doesn't matter what type of adversary we have, as we can't have some non-negligible advantage against it. Therefore, this proves that the scheme of \textbf{a} is secure.\\

 \textit{Basically just adding that 0-bit prepend to the ciphertext of the OG scheme to re-validate the $\Scheme_1$ ciphertext for the adversary.}
\end{solution}
\end{ppart}

\begin{ppart}
    Let $\Scheme_2$ be a scheme s.t. $\Enc_2(k,m) := \Enc(k,m) || \parity(m)$, where $\parity$ of a binary string refers to the number of 1 bits (equivalently, the exclusive-or of all the bits) in the string.

\begin{solution}
This scheme is \textbf{not semantically secure}, and the main reason why (which I'll show) is because this parity bit gives the attacker extra info to better guess the original message. For the sake of definitions, I'm assuming this $\parity(m)$ is just a 1-bit value, but if $\parity(m)$ outputted some multi-bit value representing the actual num. of 1's in the bit-string, this scheme would be even less secure.\\

Firstly I build an efficient adversary $\A_2$ with non-negligible advantage against $\Scheme_2$. $\A_2$ would function as such:

\begin{itemize}
    \item $\A_2$ selects two messages $m_0, m_1 \in {0,1}^L$ such that:
    \begin{itemize}
        \item $m_0 = 0^L$ (all zeros) has $\parity(m_0) = 0$
        \item $m_1 = 10^{L-1}$ (first bit 1, rest zeros) has $\parity(m_1) = 1$\\
        \textit{Keep in mind, $m_0$ and $m_1$ have the same length $L$}
    \end{itemize}
    \item $\A_2$ sends $m_0, m_1$ to the challenger.
    \item The challenger selects $b \gets {0,1}$, $k \gets \K$, computes: \\
    \begin{equation}
        c_2 = \Enc_2(k, m_b) = \Enc(k, m_b) || \parity(m_b)
    \end{equation}
    and sends $c_2$ to $\A_2$.
    \item $\A_2$ parses $c_2$ as $c || p$ where $c \in {0,1}^L$ and $p \in {0,1}$.
    \item $\A_2$ outputs $\hat{b} = p$ (the last bit of $c_2$).
\end{itemize}

Now, let $W_b$ be the event that $\A_2$ outputs 1 in Experiment $b$.

\begin{itemize}
    \item In Experiment 0 ($b=0$): The challenger encrypts $m_0 = 0^L$, which has $\parity(m_0) = 0$. The ciphertext is $c_2 = \Enc(k, m_0) || 0$. $\A_2$ outputs $p = 0$, so $\Pr[W_0] = 0$.
    \item In Experiment 1 ($b=1$): The challenger encrypts $m_1 = 10^{L-1}$, which has $\parity(m_1) = 1$. The ciphertext is $c_2 = \Enc(k, m_1) || 1$. $\A_2$ outputs $p = 1$, so $\Pr[W_1] = 1$.
\end{itemize}

Then, the semantic security advantage of $\A_2$ is:

\begin{equation}
    \SSadv[\A_2, \Scheme_2] = |\Pr[W_0] - \Pr[W_1]| = |0 - 1| = 1
\end{equation}

Because of this, $\A_2$ gets an advantage of 1 (which means it can literally distinguish EVERY message), which is not non-negligible. Therefore, $\Scheme_2$ is not semantically secure. \\

\textit{Like I said in the beginning, revealing this property of the message breaks the entire security of the scheme, as it can now be differentiated.}
\end{solution}
\end{ppart}
\end{problem}
\end{document}
 
